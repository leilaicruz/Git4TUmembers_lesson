function createCertificates() {
  var sheetId = '1_c0aVBir0a61v26WeFyCC75zFbgzJjzvrztyGLuQgic'; // Replace YOUR_SHEET_ID with your Google Sheet's ID
  var slidesId = '15QW7MinaCjdwckRsmL3cOvy8Ps1FT3lEt2Jid_QYbBs'; // Replace YOUR_SLIDES_ID with your Google Slides' ID
  var sheet = SpreadsheetApp.openById(sheetId).getSheets()[0]; // Open the first sheet
  var data = sheet.getRange('A1:A21' + sheet.getLastRow()).getValues(); // Adjust the range accordingly
  
  var slide = SlidesApp.openById(slidesId);
  var templateSlide = slide.getSlides()[0]; // Assumes the template is the first slide
  
  data.forEach(function(row) {
    var name = row[0]; // The name from the sheet
    if (name) { // Check if name is not empty
      var newSlide = slide.appendSlide(templateSlide); // Duplicate the template slide
      var textBoxes = newSlide.getShapes().filter(function(shape) {
        return shape.getShapeType() === SlidesApp.ShapeType.TEXT_BOX;
      });
      
      textBoxes.forEach(function(textBox) {
        var textRange = textBox.getText();
        var currentText = textRange.asString();
        // Replace "{{name}}" placeholder with the actual name
        if (currentText.includes("{{name}}")) {
          textRange.setText(currentText.replace("{{name}}", name));
        }
      });
    }
  });
  
  // Optionally, remove the template slide after all certificates are created
  // slide.getSlides()[0].remove();
}
